# swetest64.exe из PowerShell (Windows)

Надёжные способы вызывать swetest64.exe из PowerShell с корректной обработкой путей, кавычек и десятичных чисел.

## Ключевые советы

- В PowerShell безопаснее оборачивать запуск через `cmd /c` с полной командой в двойных кавычках.
- Формат даты: `-bD.M.Y` (европейский стиль). Время: `-utHH:MM:SS`.
- Для JD напрямую (`-bj<JD>`) часто ловим `illegal option`; надёжнее использовать дату + время.
- Указывайте эфемериды через `-edir<ABS_PATH>`.
- Топоцентрические: `-topo<lon,lat,alt>` с десятичными значениями.
- Экваториальные RA/Dec: формат `-fTAD` (добавьте `P` для имени и `R` для дистанции: `-fPTADR`).
- Подавление заголовков: `-head`.
- Эфемериды Swiss Ephemeris: `-eswe`.

## Рабочий пример (дата/время)

```
cmd /c ""C:\Users\serge\OneDrive\Documents\Fractal\Projects\Component\Swisseph\с-swisseph\swisseph\windows\programs\swetest64.exe" -b8.4.2024 -ut06:18:00 -topo-96.8,32.8,0 -p1 -fPTADR -head -eswe -edirC:\Users\serge\OneDrive\Documents\Fractal\Projects\Component\Swisseph\eph\ephe"
```

Расшифровка:
- `-b8.4.2024` — 8 апреля 2024
- `-ut06:18:00` — время UT
- `-topo-96.8,32.8,0` — долгота, широта, высота
- `-p1` — Луна
- `-fPTADR` — имя, дата, RA, Dec, расстояние
- `-head` — без шапки
- `-eswe` — использовать Swiss Ephemeris
- `-edir...` — путь к каталогу эфемерид

## Пример вывода
```
Moon            08.04.2024 6:18:00 UT    0h44'22.6312    3°45'49.9800    0.00243
```

## Типовые ошибки

| Сообщение | Причина | Решение |
|-----------|---------|---------|
| `illegal option .2630702` | Использован `-bj` в PS, парсер дробит | Используйте `-bD.M.Y -utHH:MM:SS` |
| `illegal option .04.2024` | Лишние ведущие нули | Пишите `-b8.4.2024` |
| `SwissEph file 'sepl_18.se1' not found` | Не указан путь к эфемеридам | Добавьте `-edir<path>` |
| RA/Dec не те | Неправильный формат `-f` | Используйте `-fTAD` или `-fPTADR` |

## Серийное получение эталонов

Используйте PHP-скрипт или бат-файл, перебирающий массив дат:

```
@echo off
for %%T in (06:18:00 06:19:00 06:20:00) do (
  cmd /c ""C:\path\swetest64.exe" -b8.4.2024 -ut%%T -topo-96.8,32.8,0 -p1 -fPTADR -head -eswe -edirC:\path\ephe"
)
```

## Проверка точности
Сравнивайте вывод с результатами `swe_calc_ut()` в PHP после установки топо-координат и пути эфемерид.

---
Документ создан автоматически для фиксации рабочего способа запуска swetest64.exe в PowerShell.
